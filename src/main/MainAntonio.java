package main;

import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

import javax.imageio.ImageIO;

public final class MainAntonio {
    
	public static void main(String[] args) {
	
		int image[][] = Helper.read("images/ThePersistenceOfMemory/ThePersistenceOfMemory.png");
//		int image[][] = Helper.read("images/Image_HD_Test/b807c2282ab0a491bd5c5c1051c6d312_rP0kQjJ.png");
		String message = " Il en est ainsi de notre passé. C'est peine perdue que nous cherchions à l'évoquer, tous les efforts de notre intelligence sont inutiles. Il est caché hors de son domaine et de sa portée, en quelque objet matériel (enla sensation que nous donnerait cet objet matériel) que nous ne soupçonnons pas. Cet objet, il dépend duhasard que nous le rencontrions avant de mourir, ou que nous ne le rencontrions pas. Il y avait déjà bien desannées que, de Combray, tout ce qui n'était pas le théâtre et le drame de mon coucher, n'existait plus pourmoi, quand un jour d'hiver, comme je rentrais à la maison, ma mère, voyant que j'avais froid, me proposa de me faire prendre, contre mon habitude, un peu de thé. Je refusai d'abord et, je ne sais pourquoi, me ravisai.Elle envoya chercher un de ces gâteaux courts et dodus appelés petites madeleines qui semblent avoir étémoulés dans la valve rainurée d'une coquille de Saint-jacques. Et bientôt, machinalement, accablé par lamorne journée et la perspective d'un triste lendemain, je portai à mes lèvres une cuillerée du thé où j'avaislaissé s'amollir un morceau de madeleine. Mais à l'instant même où la gorgée mêlée des miettes du gâteautoucha mon palais, je tressaillis, attentif à ce qui se passait d'extraordinaire en moi. Un plaisir délicieuxm'avait envahi, isolé, sans la notion de sa cause. Il m'avait aussitôt rendu les vicissitudes de la vieindifférentes, ses désastres inoffensifs, sa brièveté illusoire, de la même façon qu'opère l'amour, en meremplissant d'une essence précieuse: ou plutôt cette essence n'était pas en moi, elle était moi. J'avais cesséde me sentir médiocre, contingent, mortel. D'où avait pu me venircette puissante joie ? Je sentais qu'elle était liée au goût du thé et du gâteau, mais qu'elle le dépassait infiniment, ne devait pas être de même nature.D'où venait-elle ? Que signifiait -elle ? Où l'appréhender ? Je bois une seconde gorgée où je ne trouve riende plus que dans la première, une troisième qui m'apporte un peu moins que la seconde. Il est temps que jem'arrête, la vertu du breuvage semble diminuer. Il est clair que la vérité que je cherche n'est pas en lui, maisen moi. Il l'y a éveillée, mais ne la connaît pas, et ne peut que répéter indéfiniment, avec de moins en moinsde force, ce même témoignage que je ne sais pas interpréter et que je veux au moins pouvoir lui redemanderet retrouver intact, à ma disposition, tout à l'heure, pour un éclaircissement décisif. Je pose la tasse et metourne vers mon esprit. C'est à lui de trouver la vérité. Mais comment ? Grave incertitude, toutes les fois quel'esprit se sent dépassé par lui-même ; quand lui, le chercheur, est tout ensemble le pays obscur où il doitchercher et où tout son bagage ne lui see rien. Chercher ? Pas seulement : créer. Il est en face de quelquechose qui n'est pas encore et que seul il peut réaliser, puis faire entrer dans sa lumière. Et je recommence àme demander quel pouvait être cet état inconnu, qui n'apportait aucune preuve logique, mais l'évidence, de safélicité, de sa réalité devant laquelle les autres s'évanouissaient. Je veux essayer de le faire réapparaître. Jerétrograde par la pensée au moment où je pris la première cuillerée de thé. Je retrouve le même état, sans uneclarté nouvelle. Je demande à mon esprit un effort de plus, de ramener encore une fois la sensation quis'enfuit. Et, pour que rien ne brise l'élan dont il va tâcher de la ressaisir, j'écarte tout obstacle, toute idéeétrangère, j'abrite mes oreilles et mon attention contre les bruits de la chambre voisine. Mais sentant monesprit qui se fatigue sans réussir, je le force au contraire à prendre cette distraction que je lui refusais, à penserà autre chose, à se refaire avant une tentative suprême. Puis une deuxième fois, je fais le vide devant lui, jeremets en face de lui la saveur encore récente de cette première gorgée et je sens tressaillir en moi quelquechose qui se déplace, voudrait s'élever, quelque chose qu'on aurait désancré, à une grande profondeur ; je nesais ce que c'est, mais cela monte lentement ; j'éprouve la résistance et j'entends la rumeur des distancestraversées. Certes, ce qui palpite ainsi au fond de moi, ce doit être l'image, le souvenir visuel, qui, lié à cettesaveur, tente de la suivre jusqu'à moi. Mais il se débat trop loin, trop confusément ; à peine si je perçois lereflet neutre où se confond l'insaisissable tourbillon des couleurs remuées ; mais je ne peux distinguer laforme, lui demander, comme au seul interprète possible, de me traduire le témoignage de sa contemporaine,de son inséparable compagne, la saveur, lui demander de m'apprendre de quelle circonstance particulière, dequelle époque du passé il s'agit.Arrivera-t-il jusqu'à la surface de ma claire conscience, ce souvenir, l'instant ancien que l'attraction d'uninstant identique est venue de si loin solliciter, émouvoir, soulever tout au fond de moi ? Je ne sais.Maintenant je ne sens plus rien, il est arrêté, redescendu peut-être ; qui sait s'il remontera jamais de sanuit ? Dix fois il me faut recommencer, me pencher vers lui. Et chaque fois la lâcheté qui nous détourne detoute tâche difficile, de toute oeuvre importante, m'a conseillé de laisser cela, de boire mon thé en pensantsimplement à mes ennuis d'aujourd'hui, à mes désirs de demain qui se laissent remâcher sans peine.Et tout d'un coup le souvenir m'est apparu. Ce goût, c'était celui du petit morceau de madeleine que ledimanche matin à Combray (parce que ce jouàje ne sortais pas avant l'heure de la messe), quand j'allaislui dire bonjour dans sa chambre, ma tante Léonie m'offrait après l'avoir trempé dans son infusion de thé oude tilleul. La vue de la petite madeleine ne m'avait rien rappelé avant que je n'y eusse goûté ; peut-être parceque, en ayant souvent aperçu depuis, sans en manger, sur les tablettes des pâtissiers, leur image avait quittéces jours de Combray pour se lier à d'autres plus récents ; peut-être parce que, de ces souvenirs abandonnéssi longtemps hors de la mémoire, rien ne survivait, tout s'était désagrégé ; les formes - et celle aussi du petitcoquillage de pâtisserie, si grassement sensuel sous son plissage sévère et dévot - s'étaient abolies, ou,ensommeillées, avaient perdu la force d'expansion qui leur eût permis de rejoindre la conscience. Mais, quandd'un passé ancien rien ne subsiste, après la mort des êtres, après la destruction des choses, seules, plus frêlesmais plus vivaces, plus immatérielles, plus persistantes, plus fidèles, l'odeur et la saveur restent encorelongtemps, comme des âmes, à se rappeler, à attendre, à espérer, sur la ruine de tout le reste, à porter sansfléchir, sur leur gouttelette presque impalpable, l'édifice immense du souvenir. Et dès que j'eus reconnu legoût du morceau de madeleine trempé dans le tilleul que me donnait ma tante (quoique je ne susse pas encoreet dusse remettre à bien plus tard de décourir pourquoi ce souvenir me rendait si heureux), aussitôt la vieillemaison grise sur la rue, où était sa chambre, vint comme un décor de théâtre s'appliquer au petit pavillondonnant sur le jardin, qu'on avait construit pour mes parents sur ses derrières (ce pan tronqué que seul j'avaisrevu jusque-là) ; et avec la maison, la ville, depuis le matin jusqu'au soir et par tous les temps, la place où onm'envoyait avant déjeuner, les rues où j'allais faire des courses, les chemins qu'on prenait si le temps étaitbeau. Et comme dans ce jeu où les japonais s'amusent à tremper dans un bol de porcelaine rempli d'eau, de petits morceaux de papier jusque-là indistincts qui, à peine y sont-ils plongés, s'étirent, se contournent, secolorent, se différencient, deviennent des fleurs, des maisons, des personnages consistants et reconnaissables,de même maintenant toutes les fleurs de notre jardin et celles du parc de M. Swann, et les nymphéas de laVivonne, et les bonnes gens du village et leurs petits logis et l'église et tout Cray et ses environs, tout celaqui prend forme et solidité, est si, ville et jardins, de ma tasse de thé.";
//		String message = "Hello";
		Helper.show(image, "image");
		System.out.println("Message à cacher : " + message);
		int[][] imageHidden = Steganography.embedText(image, message);
		Helper.show(imageHidden, "imageHidden");
		String messageRevealed = Steganography.revealText(imageHidden);
		Helper.writeText("images/Stockage.txt", messageRevealed);
	    }
}